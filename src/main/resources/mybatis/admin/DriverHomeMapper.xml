<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.project.mapper.admin.DriverHomeMapper">


   <select id="getHomeCount" parameterType="com.project.utils.PageData" resultType="java.lang.Integer">
    select count(1)
    from
       sdb_school
       where 1=1
       and flag ='1'
       <if test="school_name !=null  and school_name != '' ">
           and school_name=#{school_name}
       </if>
       <if test="school_code !=null  and school_code != '' ">
           and school_code=#{school_code}
       </if>
   </select>

    <select id="getHomeList" parameterType="com.project.utils.PageData" resultType="java.util.Map">
    select a.id,a.school_name,a.school_location,a.school_phone,a.school_code,a.create_time,
    (select count(1) from sdb_school_album al where al.school_id=a.id and al.flag='1') as album_count
        from
        sdb_school a
    where 1=1
        and flag ='1'
        <if test="school_name !=null  and school_name != '' ">
            and a.school_name=#{school_name}
        </if>
        <if test="school_code !=null  and school_code != '' ">
            and a.school_code=#{school_code}
        </if>
        <if test="school_phone !=null  and school_phone != '' ">
            and a.school_phone=#{school_phone}
        </if>
    limit #{startIndex},#{pageSize}

   </select>

    <select id="getSchoolDetail" resultType="com.project.model.school.SchoolModel" parameterType="com.project.utils.PageData">
        select * from
        sdb_school
        where 1=1
        and flag ='1'
        <if test="id !=null  and id != '' ">
            and id=#{id}
        </if>
        <if test="school_name !=null  and school_name != '' ">
            and school_name=#{school_name}
        </if>
        <if test="school_name !=null  and school_name != '' ">
            and school_code=#{school_code}
        </if>
        limit 1
    </select>

    <insert id="save" parameterType="com.project.utils.PageData">
        <selectKey resultType="java.lang.Integer" order="AFTER" keyProperty="id">
            select LAST_INSERT_ID()
        </selectKey>
        insert into sdb_school
        <trim prefix="(" suffix=")"  suffixOverrides=",">

            <if test="school_name != null  and school_name != '' ">
                school_name,
            </if>
            <if test="school_icon != null  and school_icon != '' ">
                school_icon,
            </if>
            <if test="school_face != null  and school_face != '' ">
                school_face,
            </if>
            <if test="school_phone != null  and school_phone != '' ">
                school_phone,
            </if>
            <if test="school_describe != null  and school_describe != '' ">
                school_describe,
            </if>
            <if test="school_code != null  and school_code != '' ">
                school_code,
            </if>
            <if test="school_wxsmall_url != null  and school_wxsmall_url != '' ">
                school_wxsmall_url,
            </if>
            <if test="school_location != null  and school_location != '' ">
                school_location,
            </if>
            <if test="school_location_x != null  and school_location_x != '' ">
                school_location_x,
            </if>
            <if test="school_location_y != null  and school_location_y != '' ">
                school_location_y,
            </if>

        </trim>

        <trim prefix="values(" suffix=")"  suffixOverrides=",">

            <if test="school_name != null  and school_name != '' ">
                #{school_name},
            </if>
            <if test="school_icon != null  and school_icon != '' ">
                #{school_icon},
            </if>
            <if test="school_face != null  and school_face != '' ">
                #{school_face},
            </if>
            <if test="school_phone != null  and school_phone != '' ">
                #{school_phone},
            </if>
            <if test="school_describe != null  and school_describe != '' ">
                #{school_describe},
            </if>
            <if test="school_code != null  and school_code != '' ">
                #{school_code},
            </if>
            <if test="school_wxsmall_url != null  and school_wxsmall_url != '' ">
                #{school_wxsmall_url},
            </if>
            <if test="school_location != null  and school_location != '' ">
                #{school_location},
            </if>
            <if test="school_location_x != null  and school_location_x != '' ">
                #{school_location_x},
            </if>
            <if test="school_location_y != null  and school_location_y != '' ">
                #{school_location_y},
            </if>
        </trim>
    </insert>
</mapper>